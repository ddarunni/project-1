PHASE 1 INTEGRATION GUIDE
==========================

ðŸŽ¯ PROMPT SYSTEM ARCHITECTURE

Current System Flow:
Router â†’ Context Aware â†’ Intent Classification â†’ Query Planning â†’ Agent

Each node needs specific prompt guidance:

ðŸ“‹ **Context Aware Node Prompts**
```
CONTEXT RESOLUTION PATTERNS:
- "ê·¸ê²ƒ" + [entity from last response] â†’ Resolved reference
- "ì´ì „" + [context] â†’ Previous result reference  
- "ë”" + [scope] â†’ Expanded analysis scope
- "ë˜í•œ" + [addition] â†’ Additional dimension

ENTITY EXTRACTION PRIORITY:
1. Division names (ìŠ¤í…Œì¸ë¦¬ìŠ¤, ì „ê¸°ê°•íŒ, etc.)
2. Countries (í•œêµ­, ì¤‘êµ­, ì¼ë³¸)
3. Time periods (2023ë…„, ìƒë°˜ê¸°)
4. Metrics (ë§¤ì¶œ, ì´ìµ)
```

ðŸŽ¯ **Intent Classification Prompts**
```
INTENT MAPPING:
- aggregation: [í•©ê³„, ì´, ì „ì²´] â†’ Single metric calculation
- comparison: [ë¹„êµ, vs, ëŒ€ë¹„] â†’ Two-condition analysis
- ranking: [ìƒìœ„, í•˜ìœ„, ê°€ìž¥] â†’ Ordered results
- filtering: [ì¡°ê±´, ~ì¸, ~ë§Œ] â†’ Subset analysis
- multi-column: [2+ conditions] â†’ Complex query

COMPLEXITY SCORING:
- Simple: 1 condition (Division only)
- Medium: 2 conditions (Division + Country)
- High: 3+ conditions (Division + Country + Year + Supplier)
```

ðŸ—‚ï¸ **Query Planning Prompts**
```
STRATEGY SELECTION:
- multi_column_query: When 2+ filters detected
- comparative_analysis: When comparison intent + 2 entities
- single_column_query: When 1 filter only
- general_analysis: When no specific filters

TOOL RECOMMENDATION LOGIC:
IF (conditions >= 2) â†’ advanced_multi_column_query
ELIF (comparison_detected) â†’ comparative_analysis_tool  
ELIF (complex_question) â†’ detect_relevant_columns
ELSE â†’ existing_single_tools
```

ðŸ¤– **Agent Node Enhanced Prompts**
```
TOOL USAGE DECISION TREE:

1. MULTI-COLUMN CONDITIONS DETECTED?
   YES â†’ Use advanced_multi_column_query with all parameters
   
2. COMPARISON REQUEST DETECTED?
   YES â†’ Use comparative_analysis_tool with condition pairs
   
3. UNCERTAIN ABOUT COLUMNS?
   YES â†’ Use detect_relevant_columns first, then appropriate tool
   
4. SIMPLE SINGLE CONDITION?
   YES â†’ Use existing specialized tools

RESPONSE FORMATTING:
- Always include data source info
- Show filtering statistics (X out of Y records)
- Use business-friendly language
- Provide actionable conclusions
```

ðŸ”„ **Integration with Existing Prompts**

RECOMMENDED MIGRATION PATH:

1. **Phase 1A**: Add enhanced examples to existing fewshot
2. **Phase 1B**: Integrate new tool guidance to instructions  
3. **Phase 1C**: Full replacement with enhanced prompts

BACKWARD COMPATIBILITY:
- Keep existing examples as baseline
- Add Phase 1 examples as advanced cases
- Maintain Korean language consistency
- Preserve business domain expertise

ðŸ“Š **Performance Monitoring Prompts**

QUALITY CHECKPOINTS:
```
After each response, evaluate:
1. Was the most appropriate tool selected? 
2. Was context properly utilized?
3. Is the numerical result accurate?
4. Does the response format meet standards?
5. Would a business user understand this?
```

SUCCESS METRICS TO TRACK:
- Multi-column query success rate
- Context resolution accuracy  
- Comparison analysis completeness
- User satisfaction with responses
- Reduction in follow-up clarification questions

This integration guide ensures seamless evolution from basic Q&A to intelligent conversational analysis.